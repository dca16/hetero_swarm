# Heterogeneous Swarm Simulation

This project simulates a heterogeneous swarm of agents, including Spheros and Spotlights (drones), in a MuJoCo environment. The agents can perform various movements, including random, efficient, and ergodic, and interact with each other within the simulation environment. The Sphero agents log contacts with objects and trajectory histories throughout the simulation. The Spotlight agents use a CNN to predict the location of target objects, which have been set as green cubes.

## Features
- **Spheros**: Move using different algorithms like random, efficient, and ergodic movement.
- **Spotlights**: Capture images and classify objects, with movements including raster, ergodic, and random.
- **Simulation**: Inter-agent communication/trajectory merging and real-time visualization.

## Installation

### Prerequisites
- Python 3.9 or higher
- MuJoCo
- TensorFlow/Keras
- NumPy, Matplotlib, and other standard Python dependencies.
- Must be run in a ROS2 environment

### Steps
1. Clone this repository:
    ```sh
    git clone https://github.com/yourusername/hetero_swarm.git
    ```
2. Navigate to the project directory:
    ```sh
    cd hetero_swarm
    ```
3. Install the required Python packages:
    ```sh
    pip install -r requirements.txt
    ```

4. Set up MuJoCo following the [official guide](https://mujoco.readthedocs.io/en/latest/installation.html).

## Usage

To run a simulation, use the following command:

```sh
python multi_agent_coms.py --num_spheros 3 --num_spotlights 2 --sphero_movement ergodic --spotlight_movement random
```

## Important Files

# multi_agent_coms.py
- Simulation runner
- Command-line arguments for number of sphero agents, number of spotlight (drone) agents, and choice of supported search algorithms for each type of agent
- Command-line arguments (running with no arguments will list options for these in terminal):
- --num_spheros: number of sphero agents in simulation
- --num_spotlights: number of spotlight agents in simulation
- --sphero_movement: search algorithm for sphero agents
- --potlight_movement: search algorithm for spotlight agents
- Logs contacts, predicted locations of targets using neural network, and trajectories of sphero agents
- Plots heat map of individual and merged trajectories of each sphero agent, logged contact positions and true edges of objects, and heatmap of predicted target locations based on vision processing from spotlight agents
- Allows communication between agents within a given radius (this can be set in the subscriber_callback function in agents.py)
- Merges trajectories of sphero agents when they communicate

# agents.py
- Defines the Agent class, which has child classes Sphero and Spotlight
- Definitions for all search, communication, contact logging, vision processing, and graphing for the simulation

# generated_env.xml
- XML environment generated by running multi_agent_coms.py, adapts based on command-line arguments for number of agents in each sub-swarm

# individual_trainer.py
- Trains the CNN (gc_model.keras) used in agents.py and multi_agent_coms.py
- Uses tenserflow keras and supplied data to distinguish between images that do/do not contain a green cube, the target

# dom_trainer.py
- Trains a CNN (dom_model.keras) trained on data of all six types of objects in the environment
- Functions with 90% accuracy for images containing only one object, but cannot predict for images with more than one object present
- For images with multiple objects, individual_trainer.py should be used and trained on data with/without the target object



